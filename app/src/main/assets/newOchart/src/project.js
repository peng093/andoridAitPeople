window.__require=function t(e,o,n){function c(a,r){if(!o[a]){if(!e[a]){var s=a.split("/");if(s=s[s.length-1],!e[s]){var d="function"==typeof __require&&__require;if(!r&&d)return d(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+a+"'")}a=s}var l=o[a]={exports:{}};e[a][0].call(l.exports,function(t){return c(e[a][1][t]||t)},l,l.exports,t,e,o,n)}return o[a].exports}for(var i="function"==typeof __require&&__require,a=0;a<n.length;a++)c(n[a]);return c}({Global:[function(t,e,o){"use strict";cc._RF.push(e,"70987ShSgpNnYkAQOVghPL6","Global"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){this.ochartItem={width:252,height:334},this.mapDotItem={width:10,height:10},this.placeRect={centerX:0,centerY:0,minX:0,minY:0,maxX:0,maxY:0},this.unaddedList=[],this.mousePosition=null,this.mousedown=-1,this.isDraging=!1,this.baseUrl="",this.company=null,this.overContact=null,this.friends={facebook:[],linkedin:[]},this.Branchs={},this.theme="night-theme",this.themes={"daytime-theme":{bg:new cc.Color(235,235,235),border:new cc.Color(188,188,188),unaddedBg:new cc.Color(226,224,224),itemDefaultBg:new cc.Color(90,90,90),itemDefaultImg:new cc.Color(240,240,240)},"night-theme":{bg:new cc.Color(61,61,61),border:new cc.Color(41,41,41),unaddedBg:new cc.Color(69,69,69),itemDefaultBg:new cc.Color(65,65,65),itemDefaultImg:new cc.Color(90,90,90)}}}return t.prototype.getPeriphery=function(t,e){var o={left:0,right:0,top:0,bottom:0,width:0,height:0,centerX:0,centerY:0};return this.placeRect&&"number"==typeof this.placeRect.minX&&(o.left=this.placeRect.minX*t-t/2,o.right=this.placeRect.maxX*t+t/2,o.top=-this.placeRect.minY*e+e/2,o.bottom=-this.placeRect.maxY*e-e/2,o.width=o.right-o.left,o.height=o.top-o.bottom,o.centerX=(o.right+o.left)/2,o.centerY=(o.top+o.bottom)/2),o},Object.defineProperty(t.prototype,"ochartPeriphery",{get:function(){return this.getPeriphery(this.ochartItem.width,this.ochartItem.height)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mapPeriphery",{get:function(){return this.getPeriphery(this.mapDotItem.width,this.mapDotItem.height)},enumerable:!0,configurable:!0}),t.prototype.addUnadded=function(t){null!==t.parent&&(t.parent=null),this.unaddedList.every(function(e){return e!==t})&&this.unaddedList.push(t)},t.prototype.removeUnadded=function(t){var e=this.unaddedList.findIndex(function(e){return e===t});e>-1&&this.unaddedList.splice(e,1)},t}();o.default=new n,cc._RF.pop()},{}],ajax:[function(t,e,o){"use strict";cc._RF.push(e,"d3f8211WwZGa4r9xjTaT+LB","ajax"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../config/request");o.getOchartList=function(t){return n.default("company/getOchartList",{method:"POST",data:{id:t}})},o.setPlaces=function(t){return n.default("contacts_grids/multiSet",{method:"POST",data:t})},o.setBranchs=function(t){return n.default("contacts_company_branch/setRelation",{method:"POST",data:t})},o.setDepts=function(t){return n.default("contact/setDept",{method:"POST",data:t})},o.forbidOb=function(t){return n.default("contact/forbid_ob",{method:"POST",data:t})},cc._RF.pop()},{"../config/request":"request"}],"axon-tags":[function(t,e,o){"use strict";cc._RF.push(e,"19124bqkchFhLPUqC8eBm5C","axon-tags"),Object.defineProperty(o,"__esModule",{value:!0});o.default=[{id:37,tag_name:"brochure",project_id:1,path:"https://ici.oss-cn-hongkong.aliyuncs.com/uploads/user/20190507/201905071446367593.png-face.jpg",type:1},{id:41,tag_name:"fbli",project_id:1,path:"https://ici.oss-cn-hongkong.aliyuncs.com/uploads/user/20190507/201905071527071698.png-face.jpg",type:1},{id:38,tag_name:"Meet communication",project_id:1,path:"https://ici.oss-cn-hongkong.aliyuncs.com/uploads/user/20190507/201905071446512431.png-face.jpg",type:1},{id:39,tag_name:"qtt",project_id:1,path:"https://ici.oss-cn-hongkong.aliyuncs.com/uploads/user/20190507/201905071446317889.png-face.jpg",type:2},{id:40,tag_name:"tech",project_id:1,path:"https://ici.oss-cn-hongkong.aliyuncs.com/uploads/user/20190507/201905071446395311.png-face.jpg",type:2}],cc._RF.pop()},{}],"box-to-choose":[function(t,e,o){"use strict";cc._RF.push(e,"45375Aa/q5NDLpf9AfSqzrj","box-to-choose");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),c=this&&this.__decorate||function(t,e,o,n){var c,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var r=t.length-1;r>=0;r--)(c=t[r])&&(a=(i<3?c(a):i>3?c(e,o,a):c(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i,a,r=cc._decorator,s=r.ccclass,d=r.property,l=t("../config/Global"),p=t("../config/eventName"),u=t("../config/ajax"),h=t("../config/post-functions"),f=t("../config/functions"),g={yellow:new cc.Color(146,99,0),green:new cc.Color(29,146,0)};(function(t){t[t.none=-1]="none",t[t.left=0]="left",t[t.center=1]="center",t[t.right=2]="right"})(i||(i={})),function(t){t[t.none=0]="none",t[t.removeChart=1]="removeChart",t[t.cart=2]="cart"}(a||(a={}));var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ochartList=null,e.dragHandle=null,e.unchartedButton=null,e.isLeftMouseDown=!1,e.selectList=[],e.lockSelect=!1,e.colliderBody=null,e.isClickItem=!1,e.mouseOver=a.none,e.currentBtn=0,e}return n(e,t),e.prototype.onLoad=function(){var t=this;this.canvas=cc.find("Canvas"),this.addCartBox=cc.find("add-cart-handle-box",this.dragHandle),cc.systemEvent.on(p.default.OCHART_ITEM_DOWN,function(e,o){var n=window.event;n.altKey||(n.ctrlKey||n.shiftKey||t.init(),t.selecting(o),t.mousedown(e,!0))});var e=this.unchartedButton.color;this.unchartedButton.on(cc.Node.EventType.MOUSE_ENTER,function(){t.selectList.length&&l.default.isDraging&&(t.mouseOver=a.removeChart,t.unchartedButton.color=new cc.Color(54,141,74))}),this.unchartedButton.on(cc.Node.EventType.MOUSE_LEAVE,function(){t.mouseOver=a.none,t.unchartedButton.color=e}),this.addCartBox.on(cc.Node.EventType.MOUSE_ENTER,function(){t.selectList.length&&l.default.isDraging&&(t.mouseOver=a.cart,t.addCartBox.color=new cc.Color(49,170,26))}),this.addCartBox.on(cc.Node.EventType.MOUSE_LEAVE,function(){t.mouseOver=a.none,t.addCartBox.color=new cc.Color(170,112,26)})},e.prototype.boxShapeSelected=function(){var t={minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0};return this.selectList.forEach(function(e){e.contact.place_x<t.minX&&(t.minX=e.contact.place_x),e.contact.place_x>t.maxX&&(t.maxX=e.contact.place_x),e.contact.place_y<t.minY&&(t.minY=e.contact.place_y),e.contact.place_y>t.maxY&&(t.maxY=e.contact.place_y)}),(t.maxX-t.minX+1)*(t.maxY-t.minY+1)===this.selectList.length},e.prototype.mousedown=function(t,e){var o=this;void 0===e&&(e=!1);var n=null;if(n="selection"===t.target.name?t.target.parent:t.target,this.isClickItem=e,this.colliderBody=null,this.currentBtn=t.getButton(),h.closePoptip(),!window.event.altKey&&0===this.currentBtn){t.stopPropagation(),this.isLeftMouseDown=!0,l.default.isDraging=!0,this.colliderBody=n;var c=this.boxShapeSelected(),i=this.colliderBody.contact.place_x,a=this.colliderBody.contact.place_y;this.selectList.forEach(function(t){t.contact.place_x===i&&c?t.getChildByName("right-collider").active=!0:t.getChildByName("right-collider").active=!1,t.contact.place_y===a&&c?t.getChildByName("bottom-collider").active=!0:t.getChildByName("bottom-collider").active=!1,t.contact.place_y!==a&&t.contact.place_x!==i||!c?t.getChildByName("selection").color=g.yellow:t.getChildByName("selection").color=g.green}),this.node.active=!1,this.canvas.on(cc.Node.EventType.MOUSE_MOVE,this.mouseMove,this),this.canvas.on(cc.Node.EventType.MOUSE_UP,this.mouseUp,this);var r=!1;this.selectList.forEach(function(e){if(!e.active)return r=!0,void o.removeContact(e);e.current=o.getCurrent(e.contact),e.expected={x:null,y:null,place_x:null,place_y:null};var n=t.getLocation();e.mouseToNodePosition=e.convertToNodeSpaceAR(n),e.zIndex=5e3,e.getChildByName("expected-position").active=!0,o.ochartList!==e.parent&&(e.parent=o.ochartList)}),r&&(this.selectList=this.selectList.filter(function(t){return t.active}))}},e.prototype.mouseMove=function(t){var e=this;if(this.isLeftMouseDown){if(1!==window.event.buttons)return this.mouseUp(t);var o=t.getLocation(),n=this.ochartList.convertToNodeSpaceAR(o),c=function(t,o){var c=n.x-t.mouseToNodePosition.x,i=n.y-t.mouseToNodePosition.y;t.setPosition(c,i),t.expected.x=Math.round(c/t.width)*t.width,t.expected.y=Math.round(i/t.height)*t.height;var a=e.ochartList.convertToWorldSpaceAR(cc.v2(t.expected.x,t.expected.y)),r=t.convertToNodeSpaceAR(a),s=t.getChildByName("expected-position");s.setPosition(r),o?s.active=!1:s.active||(s.active=!0)};this.mouseOver||this.selectList.some(function(t){return t.collision.body})?this.selectList.forEach(function(t){c(t,!0)}):this.selectList.forEach(function(t){c(t)})}},e.prototype.mouseUp=function(t){var e=this;if(this.canvas.off(cc.Node.EventType.MOUSE_MOVE,this.mouseMove,this),this.canvas.off(cc.Node.EventType.MOUSE_UP,this.mouseUp,this),t.stopPropagation(),this.isLeftMouseDown){this.selectList.forEach(function(t){t.getChildByName("right-collider").active=!1,t.getChildByName("bottom-collider").active=!1}),this.isLeftMouseDown=!1;var o={company_id:l.default.company.id,grids:[]};if(this.mouseOver===a.cart){var n=[];this.selectList.forEach(function(t){t.setPosition(t.current.position),t.parent=e.ochartList,t.expected.x=null,t.expected.y=null,t.zIndex=t.current.zIndex;var o=t.getChildByName("expected-position");o.active=!1,o.setPosition(0,0),n.push(t.contact.id)}),n.length&&h.addCart(n)}else if(this.mouseOver===a.removeChart)this.selectList.forEach(function(t){o.grids.push({contact_id:t.contact.id,place_x:null,place_y:null}),t.parent=null,l.default.addUnadded(t);var e=t.getChildByName("expected-position");e.active=!1,e.setPosition(0,0)});else{this.colliderBody&&this.selectList.some(function(t){return t.collision.body})&&this.insertOperation();var c=this.ochartList.children.find(function(t){return!(e.selectList.indexOf(t)>-1)&&e.selectList.find(function(e){return t.x===e.expected.x&&t.y===e.expected.y})}),i=!1;this.selectList.forEach(function(t){if(c||null===t.expected.x||void 0===t.expected.y)if(null===t.contact.place_x)console.log("\u8fd9\u6b65\u5e94\u8be5\u6c38\u8fdc\u4e0d\u4f1a\u89e6\u53d1\uff0c\u663e\u793a\u8fd9\u6bb5\u6587\u5b57\u8bf4\u660e\u6709\u95ee\u9898"),t.parent=null;else{cc.tween(t).to(.15,{position:t.current.position}).start();var n=window.event;(n.ctrlKey||n.shiftKey)&&(i=!0)}else{if(t.expected.x!==t.current.position.x||t.expected.y!==t.current.position.y){var a=f.locationToPlace(t.expected.x,t.expected.y);t.expected.place_x=a.place_x,t.expected.place_y=a.place_y,o.grids.push({contact_id:t.contact.id,place_x:a.place_x,place_y:a.place_y})}cc.tween(t).to(.15,{position:cc.v2(t.expected.x,t.expected.y)}).start()}t.zIndex=t.current.zIndex;var r=t.getChildByName("expected-position");r.active=!1,r.setPosition(0,0),1===e.selectList.length&&c&&h.contactMerge(e.selectList[0].contact.id,c.contact.id)}),i&&!this.isClickItem&&(this.removeContact(t.target.parent),this.selectList=this.selectList.filter(function(e){return e!==t.target.parent}))}o.grids.length&&this.execRequest(o,this.selectList)}var r=window.event;r.ctrlKey||r.shiftKey?this.selectList.forEach(function(t){t.getChildByName("selection").color=g.yellow}):this.init(),l.default.isDraging=!1,this.currentBtn=-1},e.prototype.start=function(){this.node.active=!1},e.prototype.init=function(){this.selectList&&this.selectList.forEach(this.removeContact.bind(this)),this.selectList=[],this.lockSelect=!1},e.prototype.removeContact=function(t){var e=t.getChildByName("selection");e.color=g.yellow,e.active=!1,e.off(cc.Node.EventType.MOUSE_DOWN,this.mousedown,this)},e.prototype.locking=function(){this.lockSelect=!0},e.prototype.changePlace=function(t){var e={branch_id:t,ids:[]},o=[];this.selectList.forEach(function(n){n.contact.branch_id!==t&&(o.push(n),e.ids.push(n.contact.work_id),n.script.draging())}),o.length&&u.setBranchs(e).then(function(e){o.forEach(function(e){var o=e.script;e.contact.branch_id=t,o.updateAddress()}),o.forEach(function(t){t.script.draged()})}).catch(function(t){console.log("\u4fee\u6539\u5931\u8d25",t),o.forEach(function(t){t.script.draged()})})},e.prototype.changeDept=function(t){var e={company_id:l.default.company.id,dept_id:t,contact_ids:[]},o=[];this.selectList.forEach(function(n){n.contact.dept_id&&n.contact.dept_id===t||(o.push(n),e.contact_ids.push(n.contact.id),n.script.draging())}),o.length&&u.setDepts(e).then(function(e){o.forEach(function(e){var o=e.script;e.contact.dept_id=t,o.updateDept()}),o.forEach(function(t){t.script.draged()})}).catch(function(t){o.forEach(function(t){t.script.draged()}),console.log("\u4fee\u6539\u5931\u8d25",t)})},e.prototype.createAxon=function(t){var e=[];if(this.selectList.forEach(function(t){(!t.contact.tasks||0===t.contact.tasks.length&&0===t.contact.forbid_ob)&&e.push(t.contact.id)}),e.length){var o={contact_ids:e,axon:t};console.log(o),h.createAxons(o)}},e.prototype.selecting=function(t){var e=this;this.selectList.push(t);var o=t.getChildByName("selection");if(o.active=!0,o.on(cc.Node.EventType.MOUSE_DOWN,this.mousedown,this),this.selectList.find(function(t){return t.parent!==e.ochartList})){var n=this.selectList.filter(function(t){return t.parent!==e.ochartList||(e.removeContact(t),!1)});this.selectList=n}this.selectList.sort(function(t,e){return t.y>e.y?-1:t.y<e.y?1:t.x<e.x?-1:t.x>e.x?1:0})},e.prototype.getCurrent=function(t){return{position:f.placeTolocation(t.place_x,t.place_y),zIndex:t.sort}},e.prototype.insertOperation=function(){var t=this,e=this.selectList.length,o=this.selectList[0].contact,n=this.selectList[e-1].contact,c=n.place_y-o.place_y+1,i=n.place_x-o.place_x+1;if(c*i===e){var a=this.selectList.findIndex(function(t,e){if(t.collision.body)return d=t.collision,s=e,!0});if(-1!=a){var r,s=a,d=this.selectList[a].collision,p={x:0,y:0};if("left"===d.position){r=i;var u=Math.ceil((s+1)/i);p={x:d.body.x,y:d.body.y+(u-1)*l.default.ochartItem.height}}else{r=c,0===(u=(s+1)%i)&&(u=i),p={x:d.body.x-(u-1)*l.default.ochartItem.width,y:d.body.y}}var h={x:0,y:0},f={x:p.x,y:p.y};"left"===d.position?d.forward?h.x=l.default.ochartItem.width:(f.x-=l.default.ochartItem.width,h.x=-l.default.ochartItem.width):"top"===d.position&&(d.forward?h.y=-l.default.ochartItem.height:(h.y=l.default.ochartItem.height,f.y+=l.default.ochartItem.height)),this.selectList.forEach(function(t,e){var o=Math.ceil((e+1)/i);"left"===d.position?(d.forward?t.expected.x=f.x+e%i*h.x:t.expected.x=f.x+(i-1-e%i)*h.x,t.expected.y=f.y-(o-1)*l.default.ochartItem.height):"top"===d.position&&(d.forward?t.expected.y=f.y+(o-1)*h.y:t.expected.y=f.y+(c-o)*h.y,t.expected.x=f.x+e%i*l.default.ochartItem.width)});for(var g="left"===d.position?c:i,m=function(e){var o=r,n={x:f.x,y:f.y};for("left"===d.position?n.y=f.y-l.default.ochartItem.height*e:n.x=f.x+l.default.ochartItem.width*e;o>0;){var c=y.ochartList.children.some(function(e){if(e.x===n.x&&e.y===n.y)return e.current={position:e.getPosition(),zIndex:e.zIndex},e.expected={x:n.x+h.x*o,y:n.y+h.y*o},t.selectList.push(e),!0});n.x+=h.x,n.y+=h.y,c||o--}},y=this,v=0;v<g;v++)m(v)}}},e.prototype.execRequest=function(t,e){var o=this,n={};t.grids.forEach(function(t){n[t.contact_id]=t}),e.forEach(function(t){t.script.draging()}),u.setPlaces(t).then(function(){e.forEach(function(t){if(n[t.contact.id]){var e=n[t.contact.id];t.contact.place_x=e.place_x,t.contact.place_y=e.place_y;var o=f.placeTolocation(e.place_x,e.place_y);o?o.x===t.x&&o.y===t.y||t.setPosition(o):null!==t.parent&&(console.log("place \u4e0e loaction \u5bf9\u4e0d\u4e0a2"),t.parent=null,t.setPosition(cc.v2(0,0)),l.default.addUnadded(t))}t.script.draged()}),cc.systemEvent.emit(p.default.update_all)}).catch(function(){e.forEach(function(t){t.script.draged(),o.requestError(t)}),cc.systemEvent.emit(p.default.update_all)})},e.prototype.requestError=function(t){var e=this.getCurrent(t.contact);t.parent=this.ochartList,cc.tween(t).to(.15,{position:e.position}).start()},e.prototype.toggleSelect=function(t){var e=this.selectList.findIndex(function(e){return e===t});e>-1?(this.removeContact(this.selectList[e]),this.selectList.splice(e,1)):this.selecting(t)},e.prototype.onCollisionEnter=function(t,e){this.toggleSelect(t.node)},e.prototype.onCollisionExit=function(t,e){var o=this;setTimeout(function(){if(!o.lockSelect){var e=o.selectList.findIndex(function(e){return e===t.node});e>-1&&(o.removeContact(o.selectList[e]),o.selectList.splice(e,1))}})},c([d(cc.Node)],e.prototype,"ochartList",void 0),c([d(cc.Node)],e.prototype,"dragHandle",void 0),c([d(cc.Node)],e.prototype,"unchartedButton",void 0),e=c([s],e)}(cc.Component);o.default=m,cc._RF.pop()},{"../config/Global":"Global","../config/ajax":"ajax","../config/eventName":"eventName","../config/functions":"functions","../config/post-functions":"post-functions"}],"dept.config":[function(t,e,o){"use strict";cc._RF.push(e,"46b90lWjqpPTqKSXBJ86hI8","dept.config"),Object.defineProperty(o,"__esModule",{value:!0});var n=[{id:10,name:"bod",description:"bod director (exec & non-exec); share holder; nom-chairman",class:"bod-bg",color:"#004e8b",keyCode:66,code:"b"},{id:9,name:"mgmt",description:"mgmt; president; exec-chairman; ceo; founder; general director",class:"mgmt-bg",color:"#000",keyCode:77,code:"m"},{id:3,name:"fin",description:"finance; controller; accountant; treasurer",class:"fin-bg",color:"#696969",keyCode:70,code:"f"},{id:2,name:"s&m",description:"sales; marketing; business development; channel; distribution; credit ...",class:"sm-bg",color:"#FF83FA",keyCode:83,code:"s"},{id:4,name:"opt",description:"operations; assistant; administration",class:"opt-bg",color:"#A2CD5A",keyCode:67,code:"c"},{id:8,name:"r&d",description:"research and development; software; coding; programming; product manager",class:"rd-bg",color:"#118fed",keyCode:82,code:"r"},{id:6,name:"hr",description:"human resource; organization; human development; training",class:"hr-bg",color:"#A52A2A",keyCode:72,code:"h"},{id:1,name:"ict",description:"it; information technology; networking; system; information security...",class:"tech-bg",color:"#FF8C00",keyCode:84,code:"t"},{id:12,name:"eng",description:"non-ict engineering; construction; electric; automation...",class:"eng-bg",color:"#ffd23e",keyCode:69,code:"e"},{id:13,name:"proc",description:"procurement; logistics; international relationship",class:"proc-bg",color:"#24c4e2",keyCode:81,code:"q"},{id:7,name:"aud",description:"legal; counsel; audit; anti-corruption; interior; internal control; risk control",class:"leg-bg",color:"#ef563b",keyCode:65,code:"a"},{id:0,name:"none",description:"No department",class:"fff-bg",color:"#ffffff",keyCode:78,keyCode2:32,code:"n"},{id:5,name:"svc",description:"customer service; customer support; call center...",class:"svc-bg",color:"#9FB6CD",keyCode:86,code:"v"},{id:11,name:"pur",description:"public relationship; pr; market communication; marcom",class:"pr-bg",color:"#f0b5bf",keyCode:85,code:"u"}],c={};n.forEach(function(t){c[t.id]=t}),o.default={arr:n,obj:c},cc._RF.pop()},{}],"dev.contact-sort":[function(t,e,o){"use strict";function n(t){var e=["managing partner","Owner","Chairman","Chair Woman","Chair Person","Managing Director","General Director","Director General","Executive Director","MD","GD","DG","President","SEVP","EVP","SVP","VP","AVP","CEO","Ceo","CFO","Cfo","COO","Coo","CIO","Cio","CTO","Cto","CSO","Cso","Chief","Director","Head","Manager","Control","Procure","Counsel","Lawyer","Legal","Dnsreg","Dnsadm","Dnstech","Asreg","dnsreg","dnsadm","dnstech","asreg"],o=t.positions.split(";"),n=99;["account manager"].some(function(e){return-1===t.positions.toLowerCase().indexOf(e)})&&o.some(function(t){return e.some(function(e,o){if(-1!==t.indexOf(e))return n=o,!0})}),t.sort=n}function c(t){return function(e,o){return e[t]-o[t]}}function i(t,e,o){var n;if(t.contacts_works&&t.contacts_works.length&&(n=t.contacts_works.find(function(t){return t.company_id===o})),e){if(!t.contacts_works.length)return this.$icimsg.error("\u683c\u5f0f\u6709\u8bef\uff0c\u8054\u7cfb\u4eba\uff1a"+t.contact_name+" \u6ca1\u6709\u5de5\u4f5c\u7ecf\u5386\uff0cid\u4e3a\uff1a"+t.id);if(!n)return this.$icimsg.error("\u683c\u5f0f\u6709\u8bef\uff0c\u8054\u7cfb\u4eba\uff1a"+t.contact_name+" \u6ca1\u6709\u5728\u5f53\u524d\u516c\u53f8\u7684\u5de5\u4f5c\u7ecf\u5386\uff0cid\u4e3a\uff1a"+t.id);if(n.is_quit)return this.$icimsg.error("\u683c\u5f0f\u6709\u8bef\uff0c\u8054\u7cfb\u4eba\uff1a"+t.contact_name+" \u5df2\u5728\u5f53\u524d\u516c\u53f8\u79bb\u804c\uff0cid\u4e3a\uff1a"+t.id)}n&&(t.dept_id=n.dept_id,t.company_id=n.company_id,t.company=n.company,t.positions=n.positions,t.is_quit=n.is_quit,t.branch_id=n.branch_id,t.work_id=n.id)}cc._RF.push(e,"f9da7JiHOZEnpnhLLXGlWXi","dev.contact-sort"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(t,e){return t.forEach(function(t,o){i(t,!1,e),n(t)}),t.sort(c("sort")),t},cc._RF.pop()},{}],"error-config":[function(t,e,o){"use strict";cc._RF.push(e,"07577nbd59B6JyqD8EBL+f/","error-config"),Object.defineProperty(o,"__esModule",{value:!0}),o.errorConfig={common_error_code:{code:600,msg:"common error"},linkedin_no_login:{code:101,msg:"linkedin no login"},tianyancha_no_login:{code:104,msg:"tianyancha no login"},twitter_no_login:{code:102,msg:"twitter no login"},facebook_no_login:{code:103,msg:"facebook no login"},no_data_error:{code:130,msg:"no data"},no_access:{code:403,msg:"No access"},timeout_error:{code:411,msg:"abort"},network_error:{code:410,msg:"Network Error"},img_error:{code:412,msg:"Image failed"},not_found:{code:404,msg:"Not found"},parameter_error:{code:1e3,msg:"parameter error"},validate_error:{code:1001,msg:"validate error"},syntax_error:{code:2e3,msg:"Syntax error, Please contact the program manager"},collection_error:{code:2001,msg:""},abort_error:{code:3e3,msg:"\u7528\u6237\u53d6\u6d88\u64cd\u4f5c"}},o.default=o.errorConfig,cc._RF.pop()},{}],eventName:[function(t,e,o){"use strict";cc._RF.push(e,"0b186XmInxK34UZKCEoMyOc","eventName"),Object.defineProperty(o,"__esModule",{value:!0});o.default={OCHART_CENTER_CHANGE:"ochart_center_change",UNADDED_CENTER_CHANGE:"unadded_center_change",OCHART_ITEM_DOWN:"ochart_item_mousedown",update_all:"update_all",update_place:"update_place",update_select:"update_select",update_contact:"update_contact",update_branch:"update_branch",PLACE_DOWN:"place_down",DEPT_DOWN:"dept_down",AXON_DOWN:"axon_down",ERROR_HANDLE:"error_handle"},cc._RF.pop()},{}],familys:[function(t,e,o){"use strict";cc._RF.push(e,"07543/7EhFDVYJDKw2pZ1LK","familys");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),c=this&&this.__decorate||function(t,e,o,n){var c,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var r=t.length-1;r>=0;r--)(c=t[r])&&(a=(i<3?c(a):i>3?c(e,o,a):c(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=t("../config/functions"),a=cc._decorator,r=a.ccclass,s=a.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.content=null,e.family=null,e.ochartList=null,e}return n(e,t),e.prototype.onLoad=function(){this.pool=new cc.NodePool("famliy"),this.node.on(cc.Node.EventType.MOUSE_DOWN,function(t){t.stopPropagation()})},e.prototype.init=function(){var t=this;this.content.children.forEach(function(e){t.pool.put(e)}),this.content.removeAllChildren();var e=this.getFamilyGroups();e.length&&e.forEach(function(e){var o=null;(o=t.pool.size()>0?t.pool.get():cc.instantiate(t.family)).getComponent("family").init(e),o.parent=t.content})},e.prototype.isChn=function(t){return/^[\u4E00-\u9FA5]+$/.test(t)},e.prototype.getFamilyGroups=function(){var t=this,e={};this.ochartList.children.forEach(function(o){var n=o.contact,c=i.trim(n.first_name.join(",")).toLowerCase(),a=i.trim(n.last_name.join(",")).toLowerCase();(a.length>=2||1===a.length&&t.isChn(a))&&(e[a]?e[a].push(o):e[a]=[o]),a!==c&&(c.length>=2||1===c.length&&t.isChn(c))&&(e[c]?e[c].push(o):e[c]=[o])});var o=[];for(var n in e)e[n].length>=2&&o.push({family_name:n,nodes:e[n]});return o},c([s(cc.Node)],e.prototype,"content",void 0),c([s(cc.Prefab)],e.prototype,"family",void 0),c([s(cc.Node)],e.prototype,"ochartList",void 0),e=c([r],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../config/functions":"functions"}],family:[function(t,e,o){"use strict";cc._RF.push(e,"ddde04lkDZOFJR88waIu27c","family");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),c=this&&this.__decorate||function(t,e,o,n){var c,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var r=t.length-1;r>=0;r--)(c=t[r])&&(a=(i<3?c(a):i>3?c(e,o,a):c(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,r=i.property,s=t("../config/eventName"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.num=null,e.firstName=null,e.contactIds=[],e.index=0,e}return n(e,t),e.prototype.onLoad=function(){this.ochartList=cc.find("Canvas/ochart-root/ochart-body/ochart-list"),this.addTo=cc.find("Canvas/handle-btns/a_39")},e.prototype.init=function(t){this.ochartList=cc.find("Canvas/ochart-root/ochart-body/ochart-list"),this.contacts=[],t.nodes.length&&(this.contacts=t.nodes),this.num.string=this.contacts.length.toString(),this.firstName.string=t.family_name},e.prototype.blink=function(t){this.scheduleOnce(function(){t.stopAllActions();var e=cc.repeat(cc.sequence(cc.fadeTo(.3,60),cc.fadeTo(.3,255)),5);t.runAction(e)},.33)},e.prototype.onClick=function(t){var e=this;t.stopPropagation(),void 0===this.contacts[this.index]&&(this.index=0);var o=this.contacts[this.index];o&&o.parent===this.ochartList&&cc.systemEvent.emit(s.default.OCHART_CENTER_CHANGE,-o.x,-o.y,!0),this.index++,this.contacts.forEach(function(t){t&&t.parent===e.ochartList?e.blink(t.getChildByName("contact-icon-mask")):e.blink(e.addTo)})},c([r(cc.Label)],e.prototype,"num",void 0),c([r(cc.Label)],e.prototype,"firstName",void 0),e=c([a],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../config/eventName":"eventName"}],functions:[function(t,e,o){"use strict";cc._RF.push(e,"cd29cuUdARA3YD9kI21VCbm","functions"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Global");function c(t,e){if("string"==typeof t){e=e?e.replace(/([\(\)\[\]\*\+\\])/g,"\\$1"):"\\s";var o=new RegExp("^("+e+")*");return t.replace(o,"")}return t}function i(t,e){if("string"==typeof t){e=e?e.replace(/([\(\)\[\]\*\+\\])/g,"\\$1"):"\\s";var o=new RegExp("("+e+")*$");return t.replace(o,"")}return t}o.timeoutPerform=function(t){var e=0;return function(o){return new Promise(function(n,c){clearTimeout(e),e=setTimeout(function(){if("function"==typeof o){var t=o();if(t instanceof Promise)return void t.then(function(t){n(t)}).catch(c);n()}else n()},t)})}},o.ltrim=c,o.rtrim=i,o.trim=function(t,e){return"string"==typeof t?i(c(t,e),e):t},o.arrayUnique=function(t){for(var e=[],o={},n=0;n<t.length;n++){var c=t[n];"object"==typeof t[n]&&null!=t[n]&&(c=JSON.stringify(t[n])),!o[c]&&t[n]&&(e.push(t[n]),o[c]=!0)}return e},o.removeArrayItem=function(t,e){if(t&&t.length){var o=t.indexOf(e);if(o>-1)return t.splice(o,1)}},o.getUrlParam=function(t,e){var o=e||document.location.search,n=new RegExp("[?&]"+t+"=([^&]+)","g").exec(o),c="";return null!=n&&(c=n[1]),c},o.placeTolocation=function(t,e){if(null===t||void 0===t)return null;var o=t*n.default.ochartItem.width,c=-e*n.default.ochartItem.height;return cc.v2(o,c)},o.locationToPlace=function(t,e){return{place_x:parseInt(String(t/n.default.ochartItem.width)),place_y:parseInt(String(-e/n.default.ochartItem.height))}},cc._RF.pop()},{"./Global":"Global"}],game:[function(t,e,o){"use strict";cc._RF.push(e,"9d078b/oWNOGZM5VnoTLkcT","game");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),c=this&&this.__decorate||function(t,e,o,n){var c,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var r=t.length-1;r>=0;r--)(c=t[r])&&(a=(i<3?c(a):i>3?c(e,o,a):c(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,r=i.property,s=t("../config/Global"),d=t("../config/eventName"),l=t("../config/dept.config"),p=t("./dev.contact-sort"),u=t("../config/ajax"),h=t("../config/functions"),f=t("../config/post-functions"),g=0,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ochartItem=null,e.ochartList=null,e.addToBtn=null,e}return n(e,t),e.prototype.updateTheme=function(t){var e=cc.find("Canvas/Main Camera").getComponent(cc.Camera),o=cc.find("Canvas/ochart-root/ochart-body/border-bg");if(t&&(s.default.theme=t),s.default.themes[s.default.theme]){var n=s.default.themes[s.default.theme];e.backgroundColor=n.bg,o.color=n.border}this.ochartList.children.forEach(function(t){t.script?t.script.updateTheme():t.getComponent("ochart-item").updateTheme()})},e.prototype.onLoad=function(){var t=this;this.updates=this.getComponent("update"),cc.director.getCollisionManager().enabled=!0,cc.view.enableRetina(!0),cc.view.resizeWithBrowserSize(!0),cc.systemEvent.on(d.default.UNADDED_CENTER_CHANGE,function(){t.blink(t.addToBtn)}),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,function(e){var o=e.keyCode,n=window.event;if(!n.ctrlKey&&!n.ctrlKey&&!n.shiftKey)if([cc.macro.KEY.left,cc.macro.KEY.right,cc.macro.KEY.up,cc.macro.KEY.down].includes(o))t.moveOchart(o);else if(cc.macro.KEY.pageup===o)f.flipOver("up");else if(cc.macro.KEY.pagedown===o)f.flipOver("down");else if(s.default.overContact)if(cc.macro.KEY.f1===o){if(!s.default.overContact.contact.forbid_ob){var c=s.default.overContact.script.getRect(s.default.overContact.getChildByName("bgs"));f.createAxon(s.default.overContact.contact.id,c)}}else if(cc.macro.KEY.f2===o){if(!s.default.overContact.contact.forbid_ob){c=s.default.overContact.script.getRect(s.default.overContact.getChildByName("bgs"));f.createAp(s.default.overContact.contact.id,c)}}else if(cc.macro.KEY.f3===o)t.forbidOb(s.default.overContact);else{var i=l.default.arr.findIndex(function(t){return t.keyCode===o||t.keyCode2===o});if(i>-1){var a=l.default.arr[i];t.setDept(a)}}}),this.ochartPool=new cc.NodePool("ochart-item");for(var e=0;e<100;++e){var o=cc.instantiate(this.ochartItem);o.active=!1,this.ochartPool.put(o)}},e.prototype.start=function(){var t=this;if(this.updateTheme(),window.parent===window){var e=h.getUrlParam("id");if(!e)return;u.getOchartList(~~e).then(function(e){e.contacts_list=p.default(e.contacts_list,e.company.id),t.init(e)})}},e.prototype.moveOchart=function(t){var e=this.ochartList.parent,o=this.node.width,n=this.node.height,c=e.getPosition();switch(t){case cc.macro.KEY.left:c.x+=o;break;case cc.macro.KEY.right:c.x-=o;break;case cc.macro.KEY.up:c.y-=n;break;case cc.macro.KEY.down:c.y+=n}cc.systemEvent.emit(d.default.OCHART_CENTER_CHANGE,c.x,c.y,!0)},e.prototype.setDept=function(t){var e=s.default.overContact;if(t||e){if(e.isLoading)return;var o=(e.contact.dept_id||"").split(",").map(function(t){return~~t});if(0===t.id)o=[0];else if(o.includes(t.id))o.length>1?h.removeArrayItem(o,t.id):o=[0];else{if(o.length>=4)return;o.includes(0)&&h.removeArrayItem(o,0),o.push(t.id)}var n=o.join(","),c={contact_ids:[e.contact.id],company_id:s.default.company.id,dept_id:o.join(",")},i=e.script;i.loading(),u.setDepts(c).then(function(){i.loaded(),e.contact.dept_id=n,i.updateDept()}).catch(function(t){i.loaded(),console.log("\u5feb\u6377\u952e\u4fee\u6539\u90e8\u95e8\u62a5\u9519",t)})}},e.prototype.forbidOb=function(t){if(!t.isLoading){var e={contact_id:t.contact.id,forbid_ob:0===t.contact.forbid_ob?1:0};t.script.loading(),u.forbidOb(e).then(function(){t.contact.forbid_ob=e.forbid_ob,t.script.updateColorCard(),t.script.loaded()}).catch(function(){t.script.loaded()})}},e.prototype.createOchartItem=function(t){var e=null;if((e=this.ochartPool.size()>0?this.ochartPool.get():cc.instantiate(this.ochartItem)).getComponent("ochart-item").init(t,s.default.company.id),this.isInOchart(t.place_x,t.place_y)){var o=h.placeTolocation(t.place_x,t.place_y);e.setPosition(o),e.parent=this.ochartList}else e.active=!1,s.default.addUnadded(e)},e.prototype.isInOchart=function(t,e){return null!==t&&null!==e},e.prototype.init=function(t){var e=this;s.default.company=t.company,t.baseUrl&&(s.default.baseUrl=t.baseUrl),this.ochartList.children.forEach(function(t){e.ochartPool.put(t)}),this.ochartList.removeAllChildren(),s.default.unaddedList=[],t.contacts_list.forEach(function(t){e.createOchartItem(t)}),this.updates.all();var o=-s.default.placeRect.centerX*s.default.ochartItem.width,n=s.default.placeRect.centerY*s.default.ochartItem.height;cc.systemEvent.emit(d.default.OCHART_CENTER_CHANGE,o,n)},e.prototype.blink=function(t){this.scheduleOnce(function(){t.stopAllActions();var e=cc.repeat(cc.sequence(cc.fadeTo(.3,60),cc.fadeTo(.3,255)),5);t.runAction(e)},.33)},e.prototype.centerContact=function(t){t.parent===this.ochartList&&cc.systemEvent.emit(d.default.OCHART_CENTER_CHANGE,-t.x,-t.y,!0)},e.prototype.clickLinkedinFriend=function(){var t=this;s.default.friends.linkedin[g]||(g=0),s.default.friends.linkedin[g]&&(this.centerContact(s.default.friends.linkedin[g]),g++,s.default.friends.linkedin.forEach(function(e){e.parent===t.ochartList?t.blink(e.getChildByName("contact-icon-mask")):t.blink(t.addToBtn)}))},e.prototype.clickFacebookFriend=function(){var t=this;s.default.friends.facebook[g]||(g=0),s.default.friends.facebook[g]&&(this.centerContact(s.default.friends.facebook[g]),g++,s.default.friends.facebook.forEach(function(e){e.parent===t.ochartList?t.blink(e.getChildByName("contact-icon-mask")):t.blink(t.addToBtn)}))},e.prototype.clickBranch=function(t){var e=this;if(s.default.Branchs[t]){s.default.Branchs[t][g]||(g=0);var o=s.default.Branchs[t][g];o&&(this.centerContact(o),g++,s.default.Branchs[t].forEach(function(t){t.parent===e.ochartList?e.blink(t.getChildByName("contact-icon-mask")):e.blink(e.addToBtn)}))}},c([r(cc.Prefab)],e.prototype,"ochartItem",void 0),c([r(cc.Node)],e.prototype,"ochartList",void 0),c([r(cc.Node)],e.prototype,"addToBtn",void 0),e=c([a],e)}(cc.Component);o.default=m,cc._RF.pop()},{"../config/Global":"Global","../config/ajax":"ajax","../config/dept.config":"dept.config","../config/eventName":"eventName","../config/functions":"functions","../config/post-functions":"post-functions","./dev.contact-sort":"dev.contact-sort"}],"item-right-bottom-collider":[function(t,e,o){"use strict";cc._RF.push(e,"1e473j+1MpDVrt6JGK3e2wf","item-right-bottom-collider");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),c=this&&this.__decorate||function(t,e,o,n){var c,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var r=t.length-1;r>=0;r--)(c=t[r])&&(a=(i<3?c(a):i>3?c(e,o,a):c(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,r=i.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.position="left",e}return n(e,t),Object.defineProperty(e.prototype,"enterName",{get:function(){return this.position+"-enter"},enumerable:!0,configurable:!0}),e.prototype.onCollisionEnter=function(t,e){if(t.node.parent===e.node.parent.parent&&"ochart-item"===t.node.group){this.getForward(e.world.aabb,t.world.aabb);var o=this.node.parent;o.collision.position=this.position,o.collision.body=t.node,t.node.getChildByName(this.enterName).active=!0}},e.prototype.onCollisionStay=function(t,e){if(t.node.parent===e.node.parent.parent&&"ochart-item"===t.node.group){this.getForward(e.world.aabb,t.world.aabb);var o=t.node.getChildByName(this.enterName);this.node.parent.collision.forward?o.angle=0:o.angle=180}},e.prototype.getForward=function(t,e){var o=this.node.parent;"left"===this.position?t.center.x-e.center.x>0?o.collision.forward=!0:o.collision.forward=!1:"top"===this.position&&(e.center.y-t.center.y>0?o.collision.forward=!0:o.collision.forward=!1)},e.prototype.onCollisionExit=function(t,e){var o=this;setTimeout(function(t){"ochart-item"===t.group&&(t.getChildByName(o.position+"-enter").active=!1,o.node.parent.collision={body:null,forward:!0,position:""})},0,t.node)},c([r],e.prototype,"position",void 0),e=c([a],e)}(cc.Component);o.default=s,cc._RF.pop()},{}],loading:[function(t,e,o){"use strict";cc._RF.push(e,"0dee3mcOvlPDbWWva8VI3lN","loading");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),c=this&&this.__decorate||function(t,e,o,n){var c,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var r=t.length-1;r>=0;r--)(c=t[r])&&(a=(i<3?c(a):i>3?c(e,o,a):c(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,r=(i.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.actions=null,e}return n(e,t),e.prototype.onLoad=function(){this.actions=cc.repeatForever(cc.rotateBy(1,360))},e.prototype.start=function(){this.node.runAction(this.actions)},e=c([a],e)}(cc.Component));o.default=r,cc._RF.pop()},{}],"map-dot":[function(t,e,o){"use strict";cc._RF.push(e,"d1b17nX2v1OiYaewZW1+ovl","map-dot");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),c=this&&this.__decorate||function(t,e,o,n){var c,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var r=t.length-1;r>=0;r--)(c=t[r])&&(a=(i<3?c(a):i>3?c(e,o,a):c(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,r=i.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.blue=null,e.orangeNode=null,e.grey=null,e.sprite=null,e}return n(e,t),e.prototype.init=function(t){this.node.contact=t,t.tasks&&t.tasks.length?this.orangeNode.active=!0:this.orangeNode.active=!1,t.axon_ap_count?this.sprite.spriteFrame=this.blue:this.sprite.spriteFrame=this.grey},c([r(cc.SpriteFrame)],e.prototype,"blue",void 0),c([r(cc.Node)],e.prototype,"orangeNode",void 0),c([r(cc.SpriteFrame)],e.prototype,"grey",void 0),c([r(cc.Sprite)],e.prototype,"sprite",void 0),e=c([a],e)}(cc.Component);o.default=s,cc._RF.pop()},{}],"ochart-item":[function(t,e,o){"use strict";cc._RF.push(e,"b3408UwwdZB6qcRRJaZkdGA","ochart-item");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),c=this&&this.__decorate||function(t,e,o,n){var c,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var r=t.length-1;r>=0;r--)(c=t[r])&&(a=(i<3?c(a):i>3?c(e,o,a):c(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,r=i.property,s=t("../config/dept.config"),d=t("../config/Global"),l=t("../config/eventName"),p=t("../config/post-functions"),u=t("../config/ajax"),h=cc.Color.BLACK,f={default:new cc.Color(127,127,127),green:new cc.Color(0,197,8),red:new cc.Color(240,93,93),gold:h.fromHEX("#FFD700")},g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iconSprite=null,e.defaultSpriteFrame=null,e.contactTitle=null,e.bgs=null,e.addrCircle=null,e.statisticsBg=null,e.statistics=null,e.media=null,e.axon=null,e.btn=-1,e.cartTimeout=0,e.isClick=!1,e.onloaded=!1,e}return n(e,t),e.prototype.load=function(){var t=this;if(!this.onloaded){this.onloaded=!0,this.axonAction=cc.repeatForever(cc.sequence(cc.scaleTo(.3,.9),cc.scaleTo(.3,1.2))),this.regain(),this.canvas=cc.find("Canvas"),this.expected=this.node.getChildByName("expected-position"),this.ochartList=cc.find("ochart-root/ochart-body/ochart-list",this.canvas),this.dept=cc.find("dept",this.node),this.node.on(cc.Node.EventType.MOUSE_ENTER,function(e){d.default.mousedown>-1||(d.default.overContact=t.node,t.overCard(e),e.stopPropagation())}),this.node.on(cc.Node.EventType.MOUSE_LEAVE,function(){t.isClick=!1,clearTimeout(t.cartTimeout)});var e=this.iconSprite.node.parent.getBoundingBox(),o=this.addrCircle.getBoundingBox(),n=this.dept.getBoundingBox(),c=this.contactTitle.node.getBoundingBox();this.axonRect=this.axon.getBoundingBox(),this.node.on(cc.Node.EventType.MOUSE_DOWN,function(c){t.isClick=!0,clearTimeout(t.cartTimeout),p.closePoptip();var i=t.node.convertToNodeSpaceAR(c.getLocation());if(o.contains(i))0===c.getButton()&&(c.stopPropagation(),t.node.contact.branch_id&&cc.systemEvent.emit(l.default.PLACE_DOWN,c,t.node.contact.branch_id));else if(t.axonRect.contains(i))0===c.getButton()&&(c.stopPropagation(),t.node.contact.tasks.length&&cc.systemEvent.emit(l.default.AXON_DOWN,c,t.node.contact.tasks[0]));else if(e.contains(i)){if(t.node.isDarg)return;0===c.getButton()&&cc.systemEvent.emit(l.default.OCHART_ITEM_DOWN,c,t.node)}else n.contains(i)&&0===c.getButton()&&(c.stopPropagation(),t.node.contact.dept_id&&cc.systemEvent.emit(l.default.DEPT_DOWN,c,t.node.contact.dept_id))}),this.node.on(cc.Node.EventType.MOUSE_UP,function(e){var i=t.node.convertToNodeSpaceAR(e.getLocation());if(t.isClick&&0===e.getButton())if(n.contains(i)){var a=t.node.contact.dept_id.split(",");if(a.length>1){if(t.node.isLoading)return;var r=a.shift();a.push(r);var s=a.join(","),l={contact_ids:[t.node.contact.id],company_id:d.default.company.id,dept_id:s};t.loading(),u.setDepts(l).then(function(){t.node.contact.dept_id=s,t.updateDept(),t.loaded()}).catch(function(e){t.loaded()})}}else if(c.contains(i))p.contactDetail(t.node.contact.id,t.node.contact.company_id);else if(t.axon.active&&t.axonRect.contains(i))t.node.contact.tasks&&t.node.contact.tasks[0]&&p.openAxon(t.node.contact.tasks[0]);else if(o.contains(i)){var h=t.getRect(t.addrCircle);p.openAddress(h,t.node.contact.id)}t.isClick=!1})}},e.prototype.reuse=function(){this.btn=-1},e.prototype.onLoad=function(){this.load()},e.prototype.regain=function(){this.axon.stopAllActions(),this.node.script=this,this.node.isDarg=!1,this.node.isUpload=!1,this.node.isLoading=!1,this.cartTimeout=0,this.btn=-1,this.isClick=!1,this.node.collision={body:null,position:"",forward:!0},this.node.getChildByName("selection").active=!1,this.node.getChildByName("expected-position").active=!1,this.node.getChildByName("left-enter").active=!1,this.node.getChildByName("top-enter").active=!1,this.node.getChildByName("right-collider").active=!1,this.node.getChildByName("bottom-collider").active=!1,this.updateLoading()},e.prototype.getRect=function(t){var e=t.getBoundingBoxToWorld(),o=cc.game.canvas.height/this.canvas.height,n={left:e.xMin*o,right:e.xMax*o,top:(this.canvas.height-e.yMax)*o,bottom:(this.canvas.height-e.yMin)*o};return{x:n.left,y:n.top,width:n.right-n.left,height:n.bottom-n.top,left:n.left,right:n.right,top:n.top,bottom:n.bottom}},e.prototype.overCard=function(t){var e=this;clearTimeout(this.cartTimeout),this.cartTimeout=setTimeout(function(t){var o=e.getRect(e.bgs);p.openPoptip(o,e.node.contact.id)},300,t)},e.prototype.groupChanged=function(t,e){var o=this;e.group=t,e.children&&e.children.length&&e.children.forEach(function(e){o.groupChanged(t,e)})},e.prototype.init=function(t,e){this.load(),this.node.contact=t,this.updateDept(),this.updateIcon(),this.updateAddress(),this.updateMediaFriend(),this.updateStatistics(),this.updateColorCard();var o=99!==t.sort&&t.sort>=0?new cc.Color(255,233,21):new cc.Color(205,205,205);return this.contactTitle.node.color=o,this.contactTitle.string=t.positions+"\n"+t.contact_name,!0},e.prototype.updateTheme=function(){this.updateIcon(),this.updateColorCard()},e.prototype.updateMediaFriend=function(){var t=this.media.children;t.forEach(function(t){t.active=!1,t.color=f.default});for(var e=0,o=this.node.contact.contacts_infos;e<o.length;e++){var n=o[e];"facebook"==n.type?n.contacts_friends&&n.contacts_friends.length>0&&(t[0].active=!0,t[0].color=f.green):"linkedin"==n.type?n.contacts_friends&&n.contacts_friends.length>0&&(t[1].active=!0,t[1].color=f.green):"wechat"==n.type?n.contacts_friends&&n.contacts_friends.length>0&&(t[2].active=!0,t[2].color=f.green):"skype"==n.type?n.contacts_friends&&n.contacts_friends.length>0&&(t[3].active=!0,t[3].color=f.green):"email"==n.type&&(t[4].active=!0,1===n.status?t[4].color=f.green:2===n.status&&t[2].color!==f.green?t[4].color=f.red:t[4].color=f.gold)}},e.prototype.updateAddress=function(){var t=this.node.contact.branch_id,e=cc.find("addr-index",this.addrCircle),o=d.default.company.company_branchs,n="N",c=new cc.Color(165,165,165,255);if(t){var i=o.findIndex(function(e){return e.id===t});if(i>-1)n=i+1,c=o[i].check_user_id?new cc.Color(45,145,57):new cc.Color(200,56,95)}e.getComponent(cc.Label).string=String(n),cc.find("address",this.addrCircle).color=c,cc.find("addr-index",this.addrCircle).color=c},e.prototype.updateColorCard=function(){var t=this.node.contact,e=cc.find("ochart-item-inner",this.node),o=new cc.Color(54,141,74);if(this.axon.stopAllActions(),this.axon.active=!1,t.tasks&&t.tasks.length&&(this.axon.active=!0,this.axon.runAction(this.axonAction),this.scheduleOnce(function(){this.axonRect=this.axon.getBoundingBox()},.5)),t.forbid_ob)o=new cc.Color(133,42,8);else if(t.axon_ap_count)o=new cc.Color(0,81,143);else{var n=d.default.themes[d.default.theme];n&&(o=n.itemDefaultBg)}e.color=o},e.prototype.updateStatistics=function(){var t=this.node.contact;if(t.all_mezz_count){this.statisticsBg.active=!0,this.statistics.active=!0;var e=t.all_mezz_count>100?"99+":t.all_mezz_count.toString();this.statistics.getComponent(cc.Label).string=e}else this.statisticsBg.active=!1,this.statistics.active=!1},e.prototype.updateDept=function(){var t=this,e=this.node.contact.dept_id;this.bgs.children.forEach(function(t){return t.active=!1});var o=cc.find("dept-label",this.node);if(!e||"0"===e)return this.dept.active=!1,void(o.active=!1);this.dept.active=!0,o.active=!0;var n=e.split(",");n.length>4&&(n.length=4);var c=-1/n.length;n.forEach(function(e,n){var i=s.default.obj[e];if(!i)return console.log("depts %s \u4e0d\u5b58\u5728",e);var a=t.bgs.children[n];a.active=!0;var r=new cc.Color;r.fromHEX(i.color),a.color=r,0==n&&(t.dept.color=r,o.getComponent(cc.Label).string=i.code);var d=a.getComponent(cc.Sprite);d.fillStart=n*c,d.fillRange=c})},e.prototype.setDefaultIcon=function(){var t=this.iconSprite.node,e=d.default.themes[d.default.theme];t.color=e?e.itemDefaultImg:new cc.Color(200,200,200),this.iconSprite.spriteFrame=this.defaultSpriteFrame;var o=this.iconSprite.node.parent;t.width=o.width,t.height=o.height},e.prototype.unuse=function(){if(this.regain(),this.node.contact){var t=this.getContactIcon(this.node.contact.contacts_imgs);t&&(this.setDefaultIcon(),cc.loader.release(t))}},e.prototype.updateIcon=function(){var t=this,e=this.iconSprite.node,o=this.getContactIcon(this.node.contact.contacts_imgs);if(!o)return this.setDefaultIcon();this.uploading(),cc.loader.load({url:o,type:"jpg"},function(o,n){if(t.uploaded(),o)return t.setDefaultIcon();var c=t.getContactIcon(t.node.contact.contacts_imgs);if(c&&(n=cc.loader.getRes(c))){var i=t.getImgSize(n.width,n.height);e.opacity=0,e.color=new cc.Color(255,255,255),e.width=i.width,e.height=i.height,e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n);var a=cc.fadeIn(.3);e.runAction(a)}})},e.prototype.getContactIcon=function(t){if(t&&t.length){var e=t.find(function(t){return t.is_show});return e?e.thumb_path||e.file_path:t[0].thumb_path||t[0].file_path}return null},e.prototype.getImgSize=function(t,e){var o=0,n=0;t>e?(o=t/e,n=1):(o=1,n=e/t);var c=this.iconSprite.node.parent;return{width:~~(c.width*o),height:~~(c.height*n)}},e.prototype.updateLoading=function(){var t=this.node.getChildByName("loading");if(this.node.isDarg||this.node.isUpload||this.node.isLoading){if(t.active)return;t.active=!0,cc.tween(t).to(.2,{opacity:162}).start()}else{if(!t.active)return;cc.tween(t).to(.2,{opacity:0}).call(function(){t.active=!1}).start()}},e.prototype.draging=function(){this.node.isDarg=!0,this.node.getComponent(cc.BoxCollider).enabled=!1,this.updateLoading()},e.prototype.draged=function(){this.node.isDarg=!1,this.node.getComponent(cc.BoxCollider).enabled=!0,this.updateLoading()},e.prototype.uploading=function(){this.node.isUpload=!0,this.updateLoading()},e.prototype.uploaded=function(){this.node.isUpload=!1,this.updateLoading()},e.prototype.loading=function(){this.node.isLoading=!0,this.updateLoading()},e.prototype.loaded=function(){this.node.isLoading=!1,this.updateLoading()},c([r(cc.Sprite)],e.prototype,"iconSprite",void 0),c([r(cc.SpriteFrame)],e.prototype,"defaultSpriteFrame",void 0),c([r(cc.Label)],e.prototype,"contactTitle",void 0),c([r(cc.Node)],e.prototype,"bgs",void 0),c([r(cc.Node)],e.prototype,"addrCircle",void 0),c([r(cc.Node)],e.prototype,"statisticsBg",void 0),c([r(cc.Node)],e.prototype,"statistics",void 0),c([r(cc.Node)],e.prototype,"media",void 0),c([r(cc.Node)],e.prototype,"axon",void 0),e=c([a],e)}(cc.Component);o.default=g,cc._RF.pop()},{"../config/Global":"Global","../config/ajax":"ajax","../config/dept.config":"dept.config","../config/eventName":"eventName","../config/post-functions":"post-functions"}],"ochart-root":[function(t,e,o){"use strict";cc._RF.push(e,"8fb67rG8rlBCqlW/V2V3mTg","ochart-root");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),c=this&&this.__decorate||function(t,e,o,n){var c,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var r=t.length-1;r>=0;r--)(c=t[r])&&(a=(i<3?c(a):i>3?c(e,o,a):c(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,r=i.property,s=t("../config/Global"),d=t("../config/post-functions"),l=t("../config/functions"),p=t("../config/eventName"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.canvas=null,e.ochartBody=null,e.ochartList=null,e.boxChoose=null,e.mapView=null,e.mouseStart={type:"",typeId:0,x:0,y:0,position:null,bodyX:0,bodyY:0},e}return n(e,t),e.prototype.onLoad=function(){var t=this;cc.sys.dump(),console.log("\u5e73\u53f0=="+cc.sys.os),this.chooseScript=this.boxChoose.getComponent("box-to-choose"),this.chooseLabel=this.boxChoose.getChildByName("label").getComponent(cc.Label),this.canvas.on(cc.Node.EventType.MOUSE_ENTER,function(t){s.default.overContact=null,t.stopPropagation()}),this.canvas.on(cc.Node.EventType.TOUCH_START,function(e){t.mousedown(e,"",0)}),cc.systemEvent.on(p.default.PLACE_DOWN,function(e,o){t.mousedown(e,"place",o)}),cc.systemEvent.on(p.default.DEPT_DOWN,function(e,o){t.mousedown(e,"dept",o)}),cc.systemEvent.on(p.default.AXON_DOWN,function(e,o){t.mousedown(e,"axon",o)}),this.canvas.on(cc.Node.EventType.TOUCH_MOVE,function(e){if(s.default.mousePosition=t.ochartList.convertToNodeSpaceAR(e.getLocation()),"Android"==cc.sys.os){t.rightDrag(e);var o=e.getTouches();console.log("\u624b\u6307\u4e2a\u6570=="+o.length)}else{window.event.buttons?2===s.default.mousedown?t.rightDrag(e):0===s.default.mousedown&&t.boxToChoose(e):-1!==s.default.mousedown&&t.mouseup()}}),cc.systemEvent.on(p.default.update_all,function(){t.scheduleOnce(function(){t.updateVisualContent()},.4)}),window.document.addEventListener("mouseup",this.mouseup.bind(this)),this.canvas.on(cc.Node.EventType.MOUSE_UP,this.mouseup,this),this.canvas.on(cc.Node.EventType.MOUSE_WHEEL,this.mousewheel,this);var e=l.timeoutPerform(200);this.canvas.on(cc.Node.EventType.SIZE_CHANGED,function(){e(function(){t.updateVisualContent()})}),cc.systemEvent.on(p.default.OCHART_CENTER_CHANGE,this.setOchartPosition,this)},e.prototype.mousedown=function(t,e,o){var n=this;t.stopPropagation();var c=window.event;c.ctrlKey||c.shiftKey||c.altKey||(this.mouseStart.type=e,this.mouseStart.typeId=o),d.closePoptip(),"Android"!=cc.sys.os&&(s.default.mousedown=t.getButton()),this.mouseStart.x=t.getLocationX(),this.mouseStart.y=t.getLocationY(),this.mouseStart.position=this.ochartList.convertToNodeSpaceAR(t.getLocation()),this.mouseStart.bodyX=this.ochartBody.x,this.mouseStart.bodyY=this.ochartBody.y;var i=this.chooseScript.selectList.some(function(t){return t.parent!==n.ochartList});switch((0===s.default.mousedown&&!c.shiftKey&&!c.ctrlKey||i)&&this.chooseScript.init(),this.mouseStart.type){case"place":this.chooseLabel.string="Change place";break;case"dept":this.chooseLabel.string="Change func";break;case"axon":this.chooseLabel.string="Create axon";break;default:this.chooseLabel.string=""}},e.prototype.mouseup=function(){if(this.mouseStart.type)switch(this.mouseStart.type){case"place":this.chooseScript.changePlace(this.mouseStart.typeId);break;case"dept":this.chooseScript.changeDept(String(this.mouseStart.typeId));break;case"axon":this.chooseScript.createAxon(this.mouseStart.typeId)}else 0===s.default.mousedown&&this.chooseScript.locking();this.boxChoose.active=!1,this.mouseStart.type="",this.mouseStart.typeId=0,s.default.mousedown=-1,this.scheduleOnce(function(){cc.systemEvent.emit(p.default.update_select)},.1)},e.prototype.boxToChoose=function(t){var e=this.ochartList.convertToNodeSpaceAR(t.getLocation()),o={left:0,right:0,top:0,bottom:0,width:0,height:0,centerX:0,centerY:0};this.mouseStart.position.x>=e.x?(o.left=e.x,o.right=this.mouseStart.position.x):(o.left=this.mouseStart.position.x,o.right=e.x),this.mouseStart.position.y>=e.y?(o.top=this.mouseStart.position.y,o.bottom=e.y):(o.top=e.y,o.bottom=this.mouseStart.position.y),o.right-o.left>0?this.chooseLabel.enabled=!0:this.chooseLabel.enabled=!1,o.width=o.right-o.left,o.height=o.top-o.bottom,o.centerX=(o.right+o.left)/2,o.centerY=(o.top+o.bottom)/2,this.boxChoose.active=!0,this.boxChoose.setPosition(o.centerX,o.centerY),this.boxChoose.width=o.width,this.boxChoose.height=o.height,this.boxChoose.getComponent(cc.BoxCollider).size=new cc.Size(o.width,o.height)},e.prototype.mousewheel=function(t){d.closePoptip();var e,o=t.getScrollY(),n=this.node.scaleX,c=.5;o>0?c=(e=n+.1)>.7?.7:e:c=(e=n-.1)<.3?.3:e;this.node.setScale(c),this.updateVisualContent()},e.prototype.rightDrag=function(t){var e=t.getLocationX(),o=t.getLocationY(),n=this.node.scaleX,c=this.mouseStart.bodyX+1*(e-this.mouseStart.x)/n,i=this.mouseStart.bodyY+1*(o-this.mouseStart.y)/n;this.setOchartPosition(c,i)},e.prototype.setOchartPosition=function(t,e,o){var n=this,c=4*s.default.ochartItem.width,i=4*s.default.ochartItem.height,a=-s.default.ochartPeriphery.left+c,r=-s.default.ochartPeriphery.right-c,d=-s.default.ochartPeriphery.top-i,l=-s.default.ochartPeriphery.bottom+i;t<r&&(t=r),t>a&&(t=a),e>l&&(e=l),e<d&&(e=d),o?cc.tween(this.ochartBody).to(.2,{position:cc.v2(t,e)}).call(function(){n.updateVisualContent()}).start():(this.ochartBody.setPosition(t,e),this.updateVisualContent())},e.prototype.updateVisualContent=function(){var t=this.node.scaleX,e=this.canvas.width/t,o=this.canvas.height/t,n=-this.ochartBody.x,c=-this.ochartBody.y,i=n-e/2,a=n+e/2,r=c+o/2,d=c-o/2,l=[],p=s.default.ochartItem.width/2,u=s.default.ochartItem.height/2;this.ochartList.children.forEach(function(t){t.getChildByName("selection").active?(t.active||(t.active=!0),l.push(t)):t.x+p>i&&t.x-p<a&&t.y+u>d&&t.y-u<r?(t.active||(t.active=!0),l.push(t)):t.active&&(t.active=!1)}),this.ochartViewToMapView(r,a,d,i)},e.prototype.ochartViewToMapView=function(t,e,o,n){var c=t/s.default.ochartItem.height*s.default.mapDotItem.height,i=e/s.default.ochartItem.width*s.default.mapDotItem.width,a=o/s.default.ochartItem.height*s.default.mapDotItem.height,r=n/s.default.ochartItem.width*s.default.mapDotItem.width,d=(i+r)/2,l=(c+a)/2;this.mapView.setPosition(d,l),this.mapView.width=i-r,this.mapView.height=c-a},c([r(cc.Node)],e.prototype,"canvas",void 0),c([r(cc.Node)],e.prototype,"ochartBody",void 0),c([r(cc.Node)],e.prototype,"ochartList",void 0),c([r(cc.Node)],e.prototype,"boxChoose",void 0),c([r(cc.Node)],e.prototype,"mapView",void 0),e=c([a],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../config/Global":"Global","../config/eventName":"eventName","../config/functions":"functions","../config/post-functions":"post-functions"}],"parent-window-message":[function(t,e,o){"use strict";cc._RF.push(e,"c9e61iKwCZDvbt7+14YmyCE","parent-window-message");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),c=this&&this.__decorate||function(t,e,o,n){var c,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var r=t.length-1;r>=0;r--)(c=t[r])&&(a=(i<3?c(a):i>3?c(e,o,a):c(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,r=i.property,s=t("../config/Global"),d=t("../config/eventName"),l=t("../config/post-functions"),p=t("./dev.contact-sort"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ochartList=null,e.handleBtns=null,e}return n(e,t),e.prototype.onLoad=function(){var t=this;this.game=this.getComponent("game"),window.parent!==window&&l.loaded(),l.initToHtml(),window.addEventListener("message",function(e){if(e.data&&"ochart-iframe"===e.data.origin){var o=e.data,n=t.methods[o.method];n&&"function"==typeof n&&n.call(t,o.data)}}),window.addEventListener("keydown",function(t){console.log(t.code),["F1","F2","F3","F4"].includes(t.code)&&t.preventDefault()}),document.addEventListener("paste",this.onpaste),cc.game.canvas.addEventListener("dblclick",function(){l.dblclickOchart()}),cc.game.canvas.addEventListener("drop",function(t){t.preventDefault(),t.stopPropagation()}),cc.game.canvas.addEventListener("dragover",function(t){t.preventDefault(),t.stopPropagation()}),cc.systemEvent.on(d.default.ERROR_HANDLE,function(t){l.ochartError(t)})},Object.defineProperty(e.prototype,"methods",{get:function(){return{theme_change:function(t){this.game.updateTheme(t)},ochart_init:function(t){t.themeName&&this.game.updateTheme(t.themeName),this.game.init(t)},data_from_android:function(t){t.contacts_list=p.default(t.contacts_list,t.company.id),this.methods.ochart_init.call(this,t)},contact_center:function(t){var e=this.ochartList.children.find(function(e){return e.contact.id===t});if(e)return cc.systemEvent.emit(d.default.OCHART_CENTER_CHANGE,-e.x,-e.y),void this.game.blink(e);(e=s.default.unaddedList.find(function(e){return e.contact.id===t}))&&cc.systemEvent.emit(d.default.UNADDED_CENTER_CHANGE)},branch_center:function(t){this.game.clickBranch(t)},places_change:function(t){for(var e=function(e){if("{}"===JSON.stringify(t))return"break";var n=o.ochartList.children[e],c=t[n.contact.id];if(!c)return"continue";if(c.company_id!==s.default.company.id)return"continue";if(n.contact.place_x===c.place_x&&n.contact.place_y===c.place_y)return"continue";if(n.contact.place_x=c.place_x,n.contact.place_y=c.place_y,delete t[n.contact.id],null!==c.place_x){var i=s.default.ochartItem,a=n.zIndex;n.active=!0,n.zIndex=5e3,cc.tween(n).to(.3,{position:cc.v2(n.contact.place_x*i.width,-n.contact.place_y*i.height)}).call(function(){n.zIndex=a}).start()}else n.active&&cc.tween(n).to(.3,{scale:0}).call(function(){n.parent=null,n.setPosition(cc.v2(0,0)),n.setScale(1),s.default.addUnadded(n)}).start()},o=this,n=this.ochartList.children.length-1;n>=0;n--){if("break"===e(n))break}if("{}"!==JSON.stringify(t))for(n=s.default.unaddedList.length-1;n>=0&&"{}"!==JSON.stringify(t);n--){var c=s.default.unaddedList[n],i=t[c.contact.id];if(i&&i.company_id===s.default.company.id&&null!==i.place_x){c.contact.place_x=i.place_x,c.contact.place_y=i.place_y,delete t[c.contact.id];var a=s.default.ochartItem;c.parent=this.ochartList,c.active=!0,c.scale=0,s.default.removeUnadded(c),c.setPosition(cc.v2(c.contact.place_x*a.width,-c.contact.place_y*a.height)),cc.tween(c).to(.3,{scale:1}).start()}}cc.systemEvent.emit(d.default.update_place)},contact_change:function(t){null!==t.place_x?this.ochartList.children.some(function(e){if(e.contact.id===t.id)return e.contact=Object.assign(e.contact,t),e.script.init(e.contact,s.default.company.id),!0}):s.default.unaddedList.some(function(e){if(e.contact.id===t.id)return e.contact=Object.assign(e.contact,t),e.script.init(e.contact,s.default.company.id),!0}),cc.systemEvent.emit(d.default.update_contact)},branch_change:function(t){for(var e=0,o=this.ochartList.children;e<o.length;e++){var n=o[e];if("{}"===JSON.stringify(t))break;t[n.contact.id]&&(n.contact.branch_id=t[n.contact.id],delete t[n.contact.id],n.script.updateAddress())}if("{}"!==JSON.stringify(t))for(var c=0,i=s.default.unaddedList;c<i.length;c++){n=i[c];if("{}"===JSON.stringify(t))break;t[n.contact.id]&&(n.contact.branch_id=t[n.contact.id],delete t[n.contact.id],n.script.updateAddress())}cc.systemEvent.emit(d.default.update_branch)},company_change:function(t){t.company_branchs?(Object.assign(s.default.company,t),s.default.unaddedList.forEach(function(t){t.script.updateAddress()}),this.ochartList.children.forEach(function(t){t.script.updateAddress()}),cc.systemEvent.emit(d.default.update_all)):Object.assign(s.default.company,t)},contact_add:function(t){var e=this;t.forEach(function(t){e.game.createOchartItem(t)}),cc.systemEvent.emit(d.default.update_all)},contact_del:function(t){for(var e=this.ochartList.children,o=function(o){if(!t.length)return"break";var c=e[o],i=t.findIndex(function(t){return c&&c.contact.id==t});i>-1&&(t.splice(i,1),n.game.ochartPool.put(c))},n=this,c=e.length-1;c>=0;c--){if("break"===o(c))break}if(t.length){var i=s.default.unaddedList,a=function(e){if(!t.length)return"break";var o=i[e],n=t.findIndex(function(t){return o&&o.contact.id==t});n>-1&&(t.splice(n,1),s.default.removeUnadded(o))};for(c=i.length-1;c>=0;c--){if("break"===a(c))break}}cc.systemEvent.emit(d.default.update_all)},img_uploaded:function(t){s.default.unaddedList.some(function(e){if(e.contact.id===t)return e.script.uploaded(),!0})||this.ochartList.children.some(function(e){if(e.contact.id===t)return e.getComponent("ochart-item").uploaded(),!0})}}},enumerable:!0,configurable:!0}),e.prototype.onpaste=function(t){t.preventDefault(),console.log("\u7c98\u8d34\u4e8b\u4ef6");var e,o=t.clipboardData.getData("text/plain");if(s.default.overContact)t.clipboardData.files.length?(e=t.clipboardData.files[0],s.default.overContact.script.uploading(),l.pasteImg(s.default.overContact.contact.id,e)):o&&o.length>3&&l.pasteText(s.default.overContact.contact,o);else if(t.clipboardData.files.length&&s.default.mousePosition){var n=Math.floor((s.default.mousePosition.x+s.default.ochartItem.width/2)/s.default.ochartItem.width),c=-Math.floor((s.default.mousePosition.y+s.default.ochartItem.height/2)/s.default.ochartItem.height);-0==c&&(c=0),l.analysisPicture(t.clipboardData.files[0],n,c)}},e.prototype.addContact=function(){l.addContact()},e.prototype.gAt=function(){l.gAt()},e.prototype.oGen=function(){l.oGen()},e.prototype.oGenReset=function(){l.oGen(!0)},e.prototype.refreshOchart=function(){l.refreshOchart()},c([r(cc.Node)],e.prototype,"ochartList",void 0),c([r(cc.Node)],e.prototype,"handleBtns",void 0),e=c([a],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../config/Global":"Global","../config/eventName":"eventName","../config/post-functions":"post-functions","./dev.contact-sort":"dev.contact-sort"}],"post-functions":[function(t,e,o){"use strict";function n(t,e){window.parent.postMessage({origin:"ochart-iframe",method:t,data:e},"*")}cc._RF.push(e,"f5f96mu3AJP17uRric8M2xf","post-functions"),Object.defineProperty(o,"__esModule",{value:!0}),o.loaded=function(){n("iframe_loaded",null)},o.contactDetail=function(t,e){n("contact_detail",{id:t,company_id:e})},o.openPoptip=function(t,e){n("open_poptip",{rect:t,id:e})},o.openAddress=function(t,e){n("open_address",{rect:t,id:e})},o.closePoptip=function(){n("close_poptip")},o.addCart=function(t){n("add_cart",t)},o.analysisPicture=function(t,e,o){n("analysis_picture",{file:t,x:e,y:o})},o.dblclickOchart=function(){n("dblclick_ochart")},o.flipOver=function(t){n("flip_over",t)},o.addContact=function(){n("add_contact")},o.gAt=function(){n("g_at")},o.oGen=function(t){n("o_gen",t)},o.refreshOchart=function(){n("refresh_ochart")},o.openAxon=function(t){n("open_axon",t)},o.pasteText=function(t,e){n("paste_text",{contact:t,text:e})},o.pasteImg=function(t,e){n("paste_img",{id:t,file:e})},o.createAxon=function(t,e){n("create_axon",{id:t,rect:e})},o.createAp=function(t,e){n("create_ap",{id:t,rect:e})},o.contactMerge=function(t,e){n("contact_merge",{fromId:t,toId:e})},o.ochartError=function(t){n("ochart_error",t)},o.createAxons=function(t){n("create_axons",t)},o.initToHtml=function(){n("coco_component_inited",null)},cc._RF.pop()},{}],request:[function(t,e,o){"use strict";cc._RF.push(e,"ef823o1vhNG1ay9dNER6obb","request"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./error-config"),c=t("./Global"),i=t("./eventName");c.default.baseUrl="https://test3.hydrophis.cn:5632/v1/api/","fms3.hydrophis.cn"===location.host&&(c.default.baseUrl="https://fms3.hydrophis.cn/v1/api/"),o.default=function(t,e){return t?(t=c.default.baseUrl+t,"[object Object]"===String(e)&&(e=Object.assign({method:"GET",data:{},responseType:"json"},e)),new Promise(function(o,c){e.method=e.method?e.method:"GET",e.data=e.data||{};var a=[];for(var r in e.data)a.push("".concat(r,"=",e.data[r]));var s=a.join("&");"GET"===e.method&&a&&(t+=-1===t.indexOf("?")?"".concat("?",s):"".concat("&",s));var d=new XMLHttpRequest;d.responseType=e.responseType||"json",d.onreadystatechange=function(t){if(4===d.readyState){if(200!==d.status){var e=void 0;return e=0===d.status?n.default.network_error:404===d.status?n.default.not_found:n.default.common_error_code,cc.systemEvent.emit(i.default.ERROR_HANDLE,e),c(e)}return d.response&&void 0!==d.response.code?0===d.response.code?o(d.response.data):(cc.systemEvent.emit(i.default.ERROR_HANDLE,d.response),c(d.response)):(cc.systemEvent.emit(i.default.ERROR_HANDLE,d.response),o(d.response))}},d.open(e.method,t,!0),"POST"===e.method&&d.setRequestHeader("Content-Type","application/json"),d.send("POST"===e.method?JSON.stringify(e.data):null)})):Promise.reject({code:600,msg:"When requesting an interface, a url is required"})},cc._RF.pop()},{"./Global":"Global","./error-config":"error-config","./eventName":"eventName"}],"small-map":[function(t,e,o){"use strict";cc._RF.push(e,"3a0b7uKaVtLBZHVUlqt4qhP","small-map");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),c=this&&this.__decorate||function(t,e,o,n){var c,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var r=t.length-1;r>=0;r--)(c=t[r])&&(a=(i<3?c(a):i>3?c(e,o,a):c(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,r=i.property,s=t("../config/Global"),d=new cc.NodePool,l=t("../config/eventName"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.toggle=null,e.ochartList=null,e.mapDotList=null,e.mapDot=null,e}return n(e,t),e.prototype.onLoad=function(){var t=this;this.canvas=cc.find("Canvas");for(var e=!1,o=0;o<100;++o)d.put(cc.instantiate(this.mapDot));this.node.on(cc.Node.EventType.MOUSE_DOWN,function(o){if(0===o.getButton()){o.stopPropagation();var n=t.node.convertToNodeSpaceAR(o.getLocation()),c=-n.x/s.default.mapDotItem.width*s.default.ochartItem.width,i=-n.y/s.default.mapDotItem.height*s.default.ochartItem.height;cc.systemEvent.emit(l.default.OCHART_CENTER_CHANGE,c,i),e=!0}}),this.node.on(cc.Node.EventType.MOUSE_MOVE,function(o){if(e){var n=t.node.convertToNodeSpaceAR(o.getLocation()),c=-n.x/s.default.mapDotItem.width*s.default.ochartItem.width,i=-n.y/s.default.mapDotItem.height*s.default.ochartItem.height;cc.systemEvent.emit(l.default.OCHART_CENTER_CHANGE,c,i)}}),this.canvas.on(cc.Node.EventType.MOUSE_UP,function(){e=!1}),this.toggle.on(cc.Node.EventType.MOUSE_DOWN,function(t){t.stopPropagation()})},e.prototype.init=function(){var t=this;this.mapDotList.children.forEach(function(t){d.put(t)}),this.mapDotList.removeAllChildren(),this.ochartList.children.forEach(function(e){t.creatorMapDot(e.contact)});var e=this.mapDotList.parent,o=e.getComponent(cc.Widget);e.width=s.default.mapPeriphery.width+50,e.height=s.default.mapPeriphery.height+50;var n=1;(e.width>400||e.height>400)&&(n=400/e.width>400/e.height?400/e.height:400/e.width),e.setScale(n);var c=!1;0===o.right&&(c=!0);var i=.5-s.default.mapPeriphery.centerX/e.width,a=.5-s.default.mapPeriphery.centerY/e.height;e.anchorX=i,e.anchorY=a,c?(o.bottom=0,o.right=0):(o.right=(40-e.width)*n,o.bottom=(40-e.height)*n)},e.prototype.creatorMapDot=function(t){var e=null;(e=d.size()>0?d.get():cc.instantiate(this.mapDot)).getComponent("map-dot").init(t);var o=t.place_x,n=-t.place_y,c=e.width,i=e.height;null!==o&&void 0!==o&&(e.setPosition(o*c,n*i),e.parent=this.mapDotList)},e.prototype.setToggle=function(){var t=this.node.width,e=this.node.height,o=this.getComponent(cc.Widget);0===o.right?(cc.tween(o).to(.3,{right:(40-t)*this.node.scale,bottom:(40-e)*this.node.scale},{easing:"quadIn"}).start(),cc.tween(this.toggle).to(.3,{angle:180},{easing:"quadIn"}).start()):(cc.tween(o).to(.3,{right:0,bottom:0},{easing:"quadOut"}).start(),cc.tween(this.toggle).to(.3,{angle:0},{easing:"quadIn"}).start())},c([r(cc.Node)],e.prototype,"toggle",void 0),c([r(cc.Node)],e.prototype,"ochartList",void 0),c([r(cc.Node)],e.prototype,"mapDotList",void 0),c([r(cc.Prefab)],e.prototype,"mapDot",void 0),e=c([a],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../config/Global":"Global","../config/eventName":"eventName"}],"unadded-root":[function(t,e,o){"use strict";cc._RF.push(e,"9c11ar0AN9N1ZnLRNLiWBUG","unadded-root");var n=c(t("../config/Global"));c(t("../config/eventName"));function c(t){return t&&t.__esModule?t:{default:t}}cc.Class({extends:cc.Component,properties:{contactList:cc.Node,slider:cc.Slider,sliderLabel:cc.Label,unaddedButton:cc.Node,unaddedButtonLabel:cc.Label},init:function(){this.page_size=Math.floor(this.contactList.width/n.default.ochartItem.width),this.page=Math.ceil(this.contactList.children.length/this.page_size),this.unaddedButtonLabel.string=this.contactList.children.length,this.current_page>this.page&&(this.current_page=this.page||1),this.progressList=[];for(var t=0;t<this.page;t++){var e=this.page-1;this.progressList.push(parseFloat(((t+.5)/e).toFixed(3)))}0===this.page||1===this.page?this.slider.node.active=!1:this.slider.node.active=!0,this.pageToPosition(this.current_page)},onLoad:function(){var t=this;this.contactList.opacity=0,this.progressList=[],this.current_page=1,this.unaddedButton.on(cc.Node.EventType.MOUSE_DOWN,function(t){t.stopPropagation()}),this.slider.node.on(cc.Node.EventType.MOUSE_DOWN,function(t){t.stopPropagation()}),this.node.on(cc.Node.EventType.SIZE_CHANGED,this.init,this),this.contactList.on(cc.Node.EventType.CHILD_ADDED,this.init,this),this.contactList.on(cc.Node.EventType.CHILD_REMOVED,this.init,this),this.node.on(cc.Node.EventType.MOUSE_WHEEL,function(e){e.stopPropagation(),e.getScrollY()>0?t.current_page>1?(t.current_page--,t.pageToPosition(t.current_page)):t.pageToPosition(1):t.current_page<t.page?(t.current_page++,t.pageToPosition(t.current_page)):t.pageToPosition(t.current_page)})},changeSlider:function(t){var e=this.progressList.findIndex(function(e){return t.progress<e})+1;this.pageToPosition(e)},pageToPosition:function(t){this.slider.progress=(t-1)/(this.page-1),this.sliderLabel.string=t;var e=(t-1)*this.page_size,o=t*this.page_size;this.contactList.children.forEach(function(t,n){t.active=n>=e&&n<o})},toggleOpen:function(t){t.stopPropagation(),this.isOpen()?this.close():this.open()},isOpen:function(){return 356===this.node.y},open:function(){var t=this;cc.tween(this.node).to(.3,{position:cc.v2(0,356)},{easing:"backOut"}).call(function(){cc.tween(t.contactList).to(.2,{opacity:255}).start()}).start()},close:function(){var t=this;cc.tween(this.node).to(.3,{position:cc.v2(0,550)},{easing:"backIn"}).call(function(){t.contactList.opacity=0}).start()}}),cc._RF.pop()},{"../config/Global":"Global","../config/eventName":"eventName"}],update:[function(t,e,o){"use strict";cc._RF.push(e,"4c82bmUFINIGIjf+JsnhMkn","update");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),c=this&&this.__decorate||function(t,e,o,n){var c,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var r=t.length-1;r>=0;r--)(c=t[r])&&(a=(i<3?c(a):i>3?c(e,o,a):c(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,r=i.property,s=t("../config/Global"),d=t("../config/eventName"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ochartList=null,e.addToBtn=null,e.ochartBg=null,e.mapRoot=null,e.familys=null,e}return n(e,t),e.prototype.onLoad=function(){var t=this;this.chooseScript=cc.find("ochart-root/ochart-body/box-to-choose",this.node).getComponent("box-to-choose"),cc.systemEvent.on(d.default.update_all,function(){t.scheduleOnce(function(){t.all()},.4)}),cc.systemEvent.on(d.default.update_place,function(){t.scheduleOnce(function(){t.place()},.4)}),cc.systemEvent.on(d.default.update_select,function(){t.updateTotal()}),cc.systemEvent.on(d.default.update_contact,function(){t.scheduleOnce(function(){t.contactChange()},.4)}),cc.systemEvent.on(d.default.update_branch,function(){t.scheduleOnce(function(){t.updateFriendAndBranch()},.2)})},e.prototype.all=function(){this.initPlaceRect(),this.updateTotal(),this.updateFriendAndBranch(),this.updateBg(),this.familys.getComponent("familys").init(),this.mapRoot.getComponent("small-map").init()},e.prototype.place=function(){this.all()},e.prototype.contactChange=function(){this.updateTotal(),this.updateFriendAndBranch(),this.familys.getComponent("familys").init()},e.prototype.updateBg=function(){this.ochartBg.width=s.default.ochartPeriphery.width+11*s.default.ochartItem.width,this.ochartBg.height=s.default.ochartPeriphery.height+11*s.default.ochartItem.height,this.ochartBg.setPosition(s.default.ochartPeriphery.centerX,s.default.ochartPeriphery.centerY)},e.prototype.initPlaceRect=function(){var t,e,o,n,c=this.ochartList.children,i={centerX:0,centerY:0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(c.forEach(function(c){if(c.contact){var a=c.contact,r=a.place_x,s=a.place_y;i.minX>r&&(i.minX=r),i.minY>s&&(i.minY=s),i.maxX<r&&(i.maxX=r),i.maxY<s&&(i.maxY=s),a.dept_id&&a.dept_id.indexOf("9")>-1&&(n=a),a.tasks&&a.tasks.length&&(!t||t.place_y>s||t.place_y==s&&t.place_x>r)&&(t=a),a.axon_ap_count&&(!e||e.place_y>s||e.place_y==s&&e.place_x>r)&&(e=a),a.all_mezz_count&&(!o||o.place_y>s||o.place_y==s&&o.place_x>r)&&(o=a)}}),i.minX!==1/0){s.default.placeRect=i;var a=[n,t,e,o].find(function(t){return Boolean(t)});a?(s.default.placeRect.centerX=a.place_x,s.default.placeRect.centerY=a.place_y):c[0]&&c[0].contact&&(s.default.placeRect.centerX=c[0].contact.place_x,s.default.placeRect.centerY=c[0].contact.place_y)}else s.default.placeRect={centerX:0,centerY:0,minX:0,minY:0,maxX:0,maxY:0}},e.prototype.updateFriendAndBranch=function(){var t=cc.find("left-button",this.node),e=cc.find("linkedin",t),o=cc.find("facebook",t),n=cc.find("linkedin-num",e).getComponent(cc.Label),c=cc.find("facebook-num",o).getComponent(cc.Label),i=this.ochartList.children;s.default.friends.facebook=[],s.default.friends.linkedin=[],s.default.Branchs={},i.forEach(function(t){for(var e=!1,o=!1,n=t.contact,c=0,i=n.contacts_infos;c<i.length;c++){var a=i[c];if(e&&o)break;a.contacts_friends&&a.contacts_friends.length&&("linkedin"!=a.type||e||(e=!0,s.default.friends.linkedin.push(t)),"facebook"!=a.type||o||(o=!0,s.default.friends.facebook.push(t)))}if(n.branch_id){var r=s.default.Branchs[n.branch_id];r?r.push(t):s.default.Branchs[n.branch_id]=[t]}}),s.default.friends.facebook.length?(o.active=!0,c.enabled=!0,c.string=s.default.friends.facebook.length.toString()):(o.active=!1,c.enabled=!1),s.default.friends.linkedin.length?(e.active=!0,n.enabled=!0,n.string=s.default.friends.linkedin.length.toString()):(e.active=!1,n.enabled=!1)},e.prototype.updateTotal=function(){var t=cc.find("ochart-total",this.node).getComponent(cc.Label),e=cc.find("handle-btns/a_39",this.node),o=cc.find("unchart-num",e).getComponent(cc.Label),n=this.chooseScript.selectList.length,c=this.ochartList.children.length,i=s.default.unaddedList.length;o.string=i.toString(),this.addToBtn.getComponent(cc.Button).interactable=!!i,t.string="Selected: "+n+"\nOchart: "+c+"\nTotal: "+(c+i)},c([r(cc.Node)],e.prototype,"ochartList",void 0),c([r(cc.Node)],e.prototype,"addToBtn",void 0),c([r(cc.Node)],e.prototype,"ochartBg",void 0),c([r(cc.Node)],e.prototype,"mapRoot",void 0),c([r(cc.Node)],e.prototype,"familys",void 0),e=c([a],e)}(cc.Component);o.default=l,cc._RF.pop()},{"../config/Global":"Global","../config/eventName":"eventName"}],use_reversed_rotateBy:[function(t,e,o){"use strict";cc._RF.push(e,"c7350Tob+dJ8YUFI+3/sUD/","use_reversed_rotateBy"),cc.RotateBy._reverse=!0,cc._RF.pop()},{}]},{},["Global","ajax","axon-tags","dept.config","error-config","eventName","functions","post-functions","request","use_reversed_rotateBy","family","loading","map-dot","ochart-item","box-to-choose","dev.contact-sort","familys","game","item-right-bottom-collider","ochart-root","parent-window-message","small-map","unadded-root","update"]);